---
sidebar_position: 6
---

# Supabase Structure: Coming soon!

We use **Supabase** as our backend and database service. Our setup includes two separate databases: one for **production** and one for **staging**. During development, all changes are made to the staging database. The production database is only used in the live environment. This separation helps prevent accidental changes or downtime in procudtion, keeping our app stable and reliable.

## How the Database Looks

Below is a model example of our database with some notes below to help you understand what happens behind the scenes.

### Profiles

> **Note:** When a user signs in for the first time, a Supabase function runs and automatically creates a profile for them. The `onboarding_complete` field is set to `false` by default, which makes sure the user is forced to our onboarding page to fill it out and complete their profile. Once filled out and submitted, the user's gets updated with the information and their `onboarding_complete` gets set to `true` which allows them to proceed to the rest of the app.

```tsx
id: uuid; // generated by Supabase
onboarding_complete: boolean; // default: false
display_name: string; // default: null, auto-filled from Google auth
email: string; // default: null, auto-filled from Google auth
avatar: string; // default: null, auto-filled from Google auth
age_group: string; // default: null
categories: string; // default: null
hobbies: string; // default: null
avoid: text; // default: null
practical_whimsical: number; // default: null
cozy_adventurous: number; // default: null
minimal_luxurious: number; // default: null
```

### Gift_Exchanges

> **Note:** All fields in this table, except for `id` and `owner_id`, are filled out from the form the user submits when creating a gift exchange. The `id` is generated by Supabase, and `owner_id` is set to the profile ID of the user who created the exchange.

```tsx
id: uuid; // generated by Supabase
name: string;
description: string;
group_image: string;
drawing_date: Date;
exchange_date: Date;
owner_id: uuid; // the profile.id of the person who created the exchange
status: "pending" | "active" | "completed" | "cancelled"; // enum that is strict
budget: string;
```

### Gift_Exchange_Members

> **Note:** Each member is linked to a gift exchange and a user profile. The `recipient_id` is initially `null` and gets set to another member's profile ID once the gift exchange is drawn. The `has_drawn` field tracks whether the member has participated in the draw.
>
> **Important:** There must be at least 3 members in a gift exchange before the owner can perform the draw. After the draw, each member is assigned their own "Secret Santa"â€”the person whose profile ID is set in their `recipient_id` field. This is the person they will give a gift to.

```tsx
id: uuid; // generated by Supabase
gift_exchange_id: uuid; // id of the gift_exchange the member is in
user_id: uuid; // profile.id of the user who is a member of the gift_exchange
recipient_id: uuid; // default: null, until the gift exchange is drawn. Then another member's profile.id will go here when assigned
has_drawn: boolean; // default: false
```

### Gift_Suggestions

> **Note:** For each member in a gift exchange, three gift suggestions are generated by AI for their assigned recipient. This gives every Secret Santa three options to choose from when selecting a gift for the person they are gifting.

```tsx
id: number; // auto-incremented for each suggestion
gift_exchange_id: uuid; // id of the gift_exchange that this gift is a part of
giver_id: uuid; // profile.id of the person giving the gift
recipient_id: uuid; // profile.id of the person who the gift is for
suggestion: jsonb; // entire gift object that our openAI LLM generates
```
